<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laporan Hasil Test - SafetyKU Backend</title>
    <style>
        @media print {
            @page {
                size: A4;
                margin: 2cm;
            }
            body {
                margin: 0;
                padding: 0;
            }
            .no-print {
                display: none;
            }
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f5f5f5;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 40px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        .header {
            text-align: center;
            border-bottom: 4px solid #34C759;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        
        .header h1 {
            color: #34C759;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .header .subtitle {
            color: #666;
            font-size: 1.2em;
        }
        
        .meta-info {
            display: flex;
            justify-content: space-between;
            margin-bottom: 30px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        
        .meta-info div {
            flex: 1;
        }
        
        .meta-info strong {
            color: #34C759;
        }
        
        .section {
            margin-bottom: 40px;
            page-break-inside: avoid;
        }
        
        .section h2 {
            color: #34C759;
            font-size: 1.8em;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }
        
        .section h3 {
            color: #333;
            font-size: 1.4em;
            margin-top: 25px;
            margin-bottom: 15px;
        }
        
        .section h4 {
            color: #555;
            font-size: 1.2em;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #34C759 0%, #2a9f47 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .stat-card.failed {
            background: linear-gradient(135deg, #F44336 0%, #D32F2F 100%);
        }
        
        .stat-card .number {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .stat-card .label {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        table th {
            background: #34C759;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
        }
        
        table tr:hover {
            background: #f8f9fa;
        }
        
        .badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 600;
        }
        
        .badge.success {
            background: #34C759;
            color: white;
        }
        
        .badge.failed {
            background: #F44336;
            color: white;
        }
        
        .badge.warning {
            background: #FFC107;
            color: #333;
        }
        
        .badge.info {
            background: #2196F3;
            color: white;
        }
        
        .progress-bar {
            width: 100%;
            height: 30px;
            background: #e0e0e0;
            border-radius: 15px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #34C759 0%, #2a9f47 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            transition: width 0.3s ease;
        }
        
        .code-block {
            background: #f4f4f4;
            border-left: 4px solid #34C759;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        
        .improvement-card {
            background: #e8f5e9;
            border-left: 4px solid #34C759;
            padding: 20px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .improvement-card h4 {
            color: #2a9f47;
            margin-top: 0;
        }
        
        .coverage-card {
            background: #e3f2fd;
            border-left: 4px solid #2196F3;
            padding: 20px;
            margin: 15px 0;
            border-radius: 4px;
        }
        
        .coverage-card h4 {
            color: #1976D2;
            margin-top: 0;
        }
        
        .print-button {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #34C759;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 50px;
            font-size: 1.1em;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            z-index: 1000;
        }
        
        .print-button:hover {
            background: #2a9f47;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.3);
        }
        
        ul, ol {
            margin-left: 20px;
            margin-bottom: 15px;
        }
        
        li {
            margin-bottom: 8px;
        }
        
        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
            text-align: center;
            color: #666;
            font-size: 0.9em;
        }
        
        .coverage-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .coverage-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }
        
        .coverage-item .percentage {
            font-size: 2em;
            font-weight: bold;
            color: #34C759;
        }
        
        .coverage-item .label {
            font-size: 0.9em;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <button class="print-button no-print" onclick="window.print()">üìÑ Cetak / Simpan sebagai PDF</button>
    
    <div class="container">
        <div class="header">
            <h1>üß™ Laporan Hasil Test</h1>
            <div class="subtitle">SafetyKU Backend - Ringkasan Unit & Integration Testing</div>
        </div>
        
        <div class="meta-info">
            <div>
                <strong>Tanggal:</strong> 15 Januari 2025
            </div>
            <div>
                <strong>Framework Test:</strong> Jest 29.7.0 + Supertest
            </div>
            <div>
                <strong>Waktu Eksekusi:</strong> 6.599 detik
            </div>
        </div>
        
        <div class="section">
            <h2>üìä Hasil Keseluruhan</h2>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="number">29</div>
                    <div class="label">Test Berhasil</div>
                </div>
                <div class="stat-card">
                    <div class="number">0</div>
                    <div class="label">Test Gagal</div>
                </div>
                <div class="stat-card">
                    <div class="number">100%</div>
                    <div class="label">Tingkat Keberhasilan</div>
                </div>
                <div class="stat-card">
                    <div class="number">3</div>
                    <div class="label">Test Suites</div>
                </div>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" style="width: 100%;">100% Tingkat Keberhasilan</div>
            </div>
            
            <table>
                <thead>
                    <tr>
                        <th>Metrik</th>
                        <th>Nilai</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Test Suites Berhasil</td>
                        <td>3 / 3</td>
                        <td><span class="badge success">100% ‚úÖ</span></td>
                    </tr>
                    <tr>
                        <td>Test Suites Gagal</td>
                        <td>0 / 3</td>
                        <td><span class="badge success">0% ‚úÖ</span></td>
                    </tr>
                    <tr>
                        <td>Test Berhasil</td>
                        <td>29 / 29</td>
                        <td><span class="badge success">100% ‚úÖ</span></td>
                    </tr>
                    <tr>
                        <td>Test Gagal</td>
                        <td>0 / 29</td>
                        <td><span class="badge success">0% ‚úÖ</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="section">
            <h2>‚úÖ Status Test Suites</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>Test Suite</th>
                        <th>Jenis</th>
                        <th>Status</th>
                        <th>Jumlah Test</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>reportsController.test.js</strong></td>
                        <td>Unit Test</td>
                        <td><span class="badge success">‚úÖ PASSED</span></td>
                        <td>15 test</td>
                    </tr>
                    <tr>
                        <td><strong>materialsController.test.js</strong></td>
                        <td>Unit Test</td>
                        <td><span class="badge success">‚úÖ PASSED</span></td>
                        <td>10 test</td>
                    </tr>
                    <tr>
                        <td><strong>publicRoutes.test.js</strong></td>
                        <td>Integration Test</td>
                        <td><span class="badge success">‚úÖ PASSED</span></td>
                        <td>4 test</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="section">
            <h2>üìà Test Coverage</h2>
            
            <div class="coverage-grid">
                <div class="coverage-item">
                    <div class="percentage">32.29%</div>
                    <div class="label">Statements</div>
                </div>
                <div class="coverage-item">
                    <div class="percentage">33.14%</div>
                    <div class="label">Branches</div>
                </div>
                <div class="coverage-item">
                    <div class="percentage">50%</div>
                    <div class="label">Functions</div>
                </div>
                <div class="coverage-item">
                    <div class="percentage">32.29%</div>
                    <div class="label">Lines</div>
                </div>
            </div>
            
            <h3>Coverage per Modul</h3>
            <table>
                <thead>
                    <tr>
                        <th>Modul</th>
                        <th>Statements</th>
                        <th>Branches</th>
                        <th>Functions</th>
                        <th>Lines</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Controllers</strong></td>
                        <td>67.28%</td>
                        <td>65.93%</td>
                        <td>100%</td>
                        <td>67.28%</td>
                        <td><span class="badge success">‚úÖ Baik</span></td>
                    </tr>
                    <tr>
                        <td><strong>materialsController.js</strong></td>
                        <td>76.59%</td>
                        <td>92.85%</td>
                        <td>100%</td>
                        <td>76.59%</td>
                        <td><span class="badge success">‚úÖ Sangat Baik</span></td>
                    </tr>
                    <tr>
                        <td><strong>reportsController.js</strong></td>
                        <td>63.47%</td>
                        <td>61.03%</td>
                        <td>100%</td>
                        <td>63.47%</td>
                        <td><span class="badge success">‚úÖ Baik</span></td>
                    </tr>
                    <tr>
                        <td><strong>Routes (public.js)</strong></td>
                        <td>100%</td>
                        <td>100%</td>
                        <td>100%</td>
                        <td>100%</td>
                        <td><span class="badge success">‚úÖ Sempurna</span></td>
                    </tr>
                    <tr>
                        <td><strong>Middleware</strong></td>
                        <td>0%</td>
                        <td>0%</td>
                        <td>0%</td>
                        <td>0%</td>
                        <td><span class="badge warning">‚ö†Ô∏è Belum di-test</span></td>
                    </tr>
                    <tr>
                        <td><strong>Routes (auth.js, incidents.js)</strong></td>
                        <td>0%</td>
                        <td>0%</td>
                        <td>0%</td>
                        <td>0%</td>
                        <td><span class="badge warning">‚ö†Ô∏è Belum di-test</span></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="section">
            <h2>üîç Detail Test per Controller</h2>
            
            <h3>1. Reports Controller (15 tests)</h3>
            <div class="improvement-card">
                <h4>‚úÖ Test yang Berhasil:</h4>
                <ul>
                    <li><strong>createReport:</strong> Membuat laporan berhasil</li>
                    <li><strong>createReport:</strong> Validasi field yang wajib diisi</li>
                    <li><strong>createReport:</strong> Validasi ukuran gambar (max 10MB)</li>
                    <li><strong>createReport:</strong> Validasi format tanggal</li>
                    <li><strong>createReport:</strong> Deteksi severity otomatis (berat/ringan)</li>
                    <li><strong>getAllReports:</strong> Mengambil semua laporan berhasil</li>
                    <li><strong>getAllReports:</strong> Menangani error database</li>
                    <li><strong>getReportById:</strong> Mengambil laporan berdasarkan ID berhasil</li>
                    <li><strong>getReportById:</strong> Menangani laporan tidak ditemukan</li>
                    <li><strong>getReportById:</strong> Menangani error database</li>
                    <li><strong>updateReport:</strong> Update status laporan berhasil</li>
                    <li><strong>updateReport:</strong> Menangani laporan tidak ditemukan</li>
                    <li><strong>updateReport:</strong> Menangani error database</li>
                    <li><strong>deleteReport:</strong> Hapus laporan berhasil</li>
                    <li><strong>deleteReport:</strong> Menangani laporan tidak ditemukan</li>
                </ul>
            </div>
            
            <h3>2. Materials Controller (10 tests)</h3>
            <div class="improvement-card">
                <h4>‚úÖ Test yang Berhasil:</h4>
                <ul>
                    <li><strong>createMaterial:</strong> Membuat materi berhasil</li>
                    <li><strong>createMaterial:</strong> Validasi field yang wajib diisi</li>
                    <li><strong>getAllMaterials:</strong> Mengambil semua materi berhasil</li>
                    <li><strong>getAllMaterials:</strong> Menangani error database</li>
                    <li><strong>getMaterialById:</strong> Mengambil materi berdasarkan ID berhasil</li>
                    <li><strong>getMaterialById:</strong> Menangani materi tidak ditemukan</li>
                    <li><strong>getMaterialById:</strong> Menangani error database</li>
                    <li><strong>updateMaterial:</strong> Update materi berhasil</li>
                    <li><strong>updateMaterial:</strong> Menangani materi tidak ditemukan</li>
                    <li><strong>deleteMaterial:</strong> Hapus materi berhasil</li>
                </ul>
            </div>
            
            <h3>3. Integration Tests - Public Routes (4 tests)</h3>
            <div class="improvement-card">
                <h4>‚úÖ Test yang Berhasil:</h4>
                <ul>
                    <li><strong>GET /public/reports:</strong> Mengambil semua laporan via API</li>
                    <li><strong>POST /public/reports:</strong> Membuat laporan baru via API</li>
                    <li><strong>GET /public/materials:</strong> Mengambil semua materi via API</li>
                    <li><strong>POST /public/materials:</strong> Membuat materi baru via API</li>
                </ul>
            </div>
        </div>
        
        <div class="section">
            <h2>üéØ Fitur yang Di-test</h2>
            
            <h3>Reports Controller</h3>
            <ul>
                <li>‚úÖ <strong>Create Report:</strong> Validasi input, deteksi severity, handling gambar</li>
                <li>‚úÖ <strong>Get All Reports:</strong> Fetch semua laporan, format response</li>
                <li>‚úÖ <strong>Get Report by ID:</strong> Fetch laporan spesifik, error handling</li>
                <li>‚úÖ <strong>Update Report:</strong> Update status laporan</li>
                <li>‚úÖ <strong>Delete Report:</strong> Hapus laporan, error handling</li>
            </ul>
            
            <h3>Materials Controller</h3>
            <ul>
                <li>‚úÖ <strong>Create Material:</strong> Validasi input, create materi baru</li>
                <li>‚úÖ <strong>Get All Materials:</strong> Fetch semua materi</li>
                <li>‚úÖ <strong>Get Material by ID:</strong> Fetch materi spesifik</li>
                <li>‚úÖ <strong>Update Material:</strong> Update materi yang ada</li>
                <li>‚úÖ <strong>Delete Material:</strong> Hapus materi</li>
            </ul>
            
            <h3>Integration Tests</h3>
            <ul>
                <li>‚úÖ <strong>API Endpoints:</strong> Test endpoint lengkap dengan HTTP requests</li>
                <li>‚úÖ <strong>Request/Response:</strong> Validasi format request dan response</li>
                <li>‚úÖ <strong>Database Integration:</strong> Test dengan database connection</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>üìù Best Practices yang Diterapkan</h2>
            
            <h3>Unit Testing</h3>
            <ul>
                <li>‚úÖ Mock database queries untuk isolasi test</li>
                <li>‚úÖ Test semua skenario (success, error, edge cases)</li>
                <li>‚úÖ Validasi input dan output</li>
                <li>‚úÖ Error handling yang komprehensif</li>
            </ul>
            
            <h3>Integration Testing</h3>
            <ul>
                <li>‚úÖ Test endpoint lengkap dengan Supertest</li>
                <li>‚úÖ Test dengan database connection real</li>
                <li>‚úÖ Validasi HTTP status codes</li>
                <li>‚úÖ Validasi response structure</li>
            </ul>
            
            <h3>Test Structure</h3>
            <div class="code-block">
- Setup dan teardown yang proper
- Mock data yang konsisten
- Test cases yang jelas dan deskriptif
- Isolasi test (tidak saling bergantung)
            </div>
        </div>
        
        <div class="section">
            <h2>üöÄ Area untuk Peningkatan</h2>
            
            <h3>Coverage yang Bisa Ditingkatkan</h3>
            <div class="coverage-card">
                <h4>Middleware (0% coverage)</h4>
                <ul>
                    <li>auth.js - Authentication middleware</li>
                    <li>errorHandler.js - Error handling middleware</li>
                </ul>
                <p><strong>Rekomendasi:</strong> Tambahkan unit test untuk middleware</p>
            </div>
            
            <div class="coverage-card">
                <h4>Routes Lainnya (0% coverage)</h4>
                <ul>
                    <li>auth.js - Authentication routes</li>
                    <li>incidents.js - Incident management routes</li>
                </ul>
                <p><strong>Rekomendasi:</strong> Tambahkan integration test untuk routes ini</p>
            </div>
            
            <h3>Test Cases yang Bisa Ditambahkan</h3>
            <ul>
                <li>‚úÖ Test untuk edge cases (boundary values)</li>
                <li>‚úÖ Test untuk concurrent requests</li>
                <li>‚úÖ Test untuk performance (load testing)</li>
                <li>‚úÖ Test untuk security (SQL injection, XSS, dll.)</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>üìö File Test yang Dibuat</h2>
            
            <h3>Unit Tests</h3>
            <ul>
                <li>‚úÖ <code>tests/unit/reportsController.test.js</code> - 15 tests</li>
                <li>‚úÖ <code>tests/unit/materialsController.test.js</code> - 10 tests</li>
            </ul>
            
            <h3>Integration Tests</h3>
            <ul>
                <li>‚úÖ <code>tests/integration/publicRoutes.test.js</code> - 4 tests</li>
            </ul>
            
            <h3>Test Helpers</h3>
            <ul>
                <li>‚úÖ <code>tests/helpers/testHelpers.js</code> - Utility functions</li>
                <li>‚úÖ <code>tests/setup.js</code> - Test setup configuration</li>
            </ul>
        </div>
        
        <div class="section">
            <h2>üéâ Pencapaian</h2>
            
            <div class="improvement-card">
                <h4>‚úÖ 100% Test Pass Rate!</h4>
                <p><strong>Semua 29 test berhasil tanpa ada yang gagal!</strong></p>
                <ul>
                    <li>‚úÖ 3 test suites - Semua passed</li>
                    <li>‚úÖ 29 test cases - Semua passed</li>
                    <li>‚úÖ 0 test failed</li>
                    <li>‚úÖ Coverage controllers: 67.28% (sangat baik)</li>
                    <li>‚úÖ Coverage routes (public): 100% (sempurna)</li>
                </ul>
            </div>
            
            <div class="improvement-card">
                <h4>‚úÖ Kualitas Test yang Baik</h4>
                <ul>
                    <li>Test terstruktur dengan baik</li>
                    <li>Coverage yang memadai untuk controllers</li>
                    <li>Integration test yang komprehensif</li>
                    <li>Error handling yang di-test dengan baik</li>
                </ul>
            </div>
        </div>
        
        <div class="footer">
            <p><strong>SafetyKU - Sistem Pelaporan Keselamatan dan Kesehatan Kerja</strong></p>
            <p>Dibuat: 15 Januari 2025 | Framework Test: Jest 29.7.0 + Supertest</p>
            <p>Copyright ¬© 2025 SafetyKU | AndraIndustries</p>
        </div>
    </div>
</body>
</html>

